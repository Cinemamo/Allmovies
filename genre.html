<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title id="genre-title"></title>
  <link rel="stylesheet" href="home.css" />
</head>
<body>
  <div class="navbar">
    <!-- Optional navbar -->
  </div>

  <h1 id="genre-heading"></h1>

  <div id="movies-list" class="movie-list">
    <!-- Movies will be displayed here -->
  </div>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const genreId = urlParams.get('genre');
    const genreName = urlParams.get('name');

    document.getElementById('genre-title').textContent = `${genreName} Movies`;
    document.getElementById('genre-heading').textContent = `${genreName} Movies`;

    async function fetchMoviesByGenre(genreId) {
      const res = await fetch(`https://api.themoviedb.org/3/discover/movie?api_key=27077b0de31705d036e5367a680c8d5f&with_genres=${genreId}`);
      const data = await res.json();
      return data.results;
    }

    function displayMovies(movies) {
      const movieContainer = document.getElementById('movies-list');
      movieContainer.innerHTML = '';

      movies.forEach(movie => {
        const movieItem = document.createElement('div');
        movieItem.classList.add('movie-item');

        const movieImage = document.createElement('img');
        movieImage.src = `https://image.tmdb.org/t/p/w500${movie.poster_path}`;
        movieImage.alt = movie.title;
        movieItem.appendChild(movieImage);

        const movieTitle = document.createElement('p');
        movieTitle.textContent = movie.title;
        movieItem.appendChild(movieTitle);

        // Redirect to watch.html with movie ID
        movieItem.addEventListener('click', () => {
          window.location.href = `watch.html?id=${movie.id}`;
        });

        movieContainer.appendChild(movieItem);
      });
    }

    window.onload = async () => {
      const movies = await fetchMoviesByGenre(genreId);
      displayMovies(movies);
    };
  </script>
</body>
</html>
